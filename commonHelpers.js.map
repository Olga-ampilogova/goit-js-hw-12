{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\r\n// Додатковий імпорт стилів\r\nimport \"izitoast/dist/css/iziToast.min.css\";\r\n// Описаний у документації\r\nimport SimpleLightbox from \"simplelightbox\";\r\n// Додатковий імпорт стилів\r\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\r\nimport axios from \"axios\";\r\n\r\nconst galleryTile = document.querySelector('.gallery');\r\nconst searchValue = document.querySelector('.searchform')\r\nconst searchForm = document.querySelector('.search-form');\r\nconst loadIndicator  = document.querySelector('.spinner');\r\nconst loadMoreButton = document.querySelector('.load_more');\r\n\r\nlet perPage = 40;\r\nlet page = 1;\r\nconst totalPages = Math.ceil(100 / perPage);\r\nlet gallery = new SimpleLightbox('.gallery a', { captionDelay: 250, captionsData: 'alt', close: true, className: 'modal-style' });\r\ngallery.on('show.simplelightbox', function () {});\r\naxios.defaults.baseURL = 'https://pixabay.com/api';\r\nconst myAPI_KEY = '41618210-7d4eb9e03ab25b6c1f3452a1d';\r\nconst queryParams = {\r\n    key: myAPI_KEY,\r\n    q: '',\r\n    image_type: 'photo',\r\n    orientation: 'horizontal',\r\n    safesearch: 'true',\r\n    per_page: perPage,\r\n    page: page,\r\n};\r\n\r\nasync function fetchPhotos() {\r\n    showLoadIndicator();\r\n    hideMoreButton()\r\n\r\n    try {\r\n        queryParams.page = page;\r\n        const response = await axios.get('/', { params: queryParams });\r\n        const { hits } = response.data;\r\n\r\n        if (hits.length === 0) {\r\n            iziToast.error({\r\n                title: 'Error',\r\n                position: 'topCenter',\r\n                message: \"Sorry, there are no images matching your search query. Please try again!\"\r\n            });\r\n            return console.log(response.data);\r\n        }\r\n\r\n        let renderImages = hits.reduce(\r\n            (html, image) =>\r\n                html +\r\n                `<li class=\"gallery-item\">\r\n                        <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\r\n                            <img class=\"gallery-image\" data-source=\"${image.largeImageURL}\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" width=\"360\" height=\"200\"/>\r\n                        </a>\r\n                        <div class='title'>\r\n                            <p>Likes:<span class=\"value\">${image.likes}</span></p>\r\n                            <p>Views:<span class=\"value\">${image.views}</span></p>\r\n                            <p>Comments:<span class=\"value\">${image.comments}</span></p>\r\n                            <p>Downloads:<span class=\"value\">${image.downloads}</span></p>\r\n                        </div>\r\n                </li>`,\r\n            '');\r\n        galleryTile.insertAdjacentHTML(\"beforeend\", renderImages);\r\n        gallery.refresh();\r\n        hideLoadIndicator();\r\n        if (page >= totalPages) {\r\n            iziToast.info({\r\n                position: \"topCenter\",\r\n                message: \"We're sorry, there are no more posts to load\"\r\n            });\r\n        }\r\n        else {\r\n            showMoreButton();\r\n        }\r\n    } catch (error) {\r\n        console.error(error);\r\n    }\r\n}\r\nloadMoreButton.addEventListener(\"click\", async () => {\r\n    hideMoreButton();\r\n    showLoadIndicator();\r\n    page += 1;\r\n    queryParams.page = page;\r\n    try {\r\n        await fetchPhotos();\r\n    } catch (error) {\r\n        console.log(error);\r\n    }\r\n    const myImage = document.querySelector('.gallery-item');\r\n    const buttonRect = myImage.getBoundingClientRect();\r\n    const buttonHeight = buttonRect.height;\r\n    window.scrollBy({\r\n        top: buttonHeight*2,\r\n        behavior: 'smooth',\r\n    });\r\n});\r\n\r\nsearchForm.addEventListener('submit', (event) => {\r\n    event.preventDefault();\r\n    page = 1;\r\n    cleanScreen();\r\n    hideMoreButton();\r\n    if (searchValue.value.trim().length === 0) {\r\n        iziToast.error({\r\n            title: 'Error',\r\n            position: 'topCenter',\r\n            message: \"Sorry, Please choose a topic.\"\r\n         });\r\n        return;\r\n    }\r\n    showLoadIndicator();\r\n    queryParams.q = searchValue.value;\r\n    fetchPhotos();\r\n    searchValue.value = '';\r\n});\r\n\r\nfunction cleanScreen() {\r\n    galleryTile.replaceChildren();\r\n}\r\n\r\nfunction hideLoadIndicator() {\r\n    loadIndicator .style.visibility = 'hidden';\r\n}\r\n\r\nfunction showLoadIndicator() {\r\n    loadIndicator .style.visibility = 'visible';\r\n}\r\n\r\nfunction showMoreButton() {\r\n    loadMoreButton.style.visibility = 'visible';\r\n}\r\n\r\nfunction hideMoreButton() {\r\n    loadMoreButton.style.visibility = 'hidden';\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["galleryTile","searchValue","searchForm","loadIndicator","loadMoreButton","perPage","page","totalPages","gallery","SimpleLightbox","axios","myAPI_KEY","queryParams","fetchPhotos","showLoadIndicator","hideMoreButton","response","hits","iziToast","renderImages","html","image","hideLoadIndicator","showMoreButton","error","buttonHeight","event","cleanScreen"],"mappings":"owBASA,MAAMA,EAAc,SAAS,cAAc,UAAU,EAC/CC,EAAc,SAAS,cAAc,aAAa,EAClDC,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAiB,SAAS,cAAc,UAAU,EAClDC,EAAiB,SAAS,cAAc,YAAY,EAE1D,IAAIC,EAAU,GACVC,EAAO,EACX,MAAMC,EAAa,KAAK,KAAK,IAAMF,CAAO,EAC1C,IAAIG,EAAU,IAAIC,EAAe,aAAc,CAAE,aAAc,IAAK,aAAc,MAAO,MAAO,GAAM,UAAW,aAAe,CAAA,EAChID,EAAQ,GAAG,sBAAuB,UAAY,CAAA,CAAE,EAChDE,EAAM,SAAS,QAAU,0BACzB,MAAMC,EAAY,qCACZC,EAAc,CAChB,IAAKD,EACL,EAAG,GACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAUN,EACV,KAAMC,CACV,EAEA,eAAeO,GAAc,CACzBC,IACAC,EAAgB,EAEhB,GAAI,CACAH,EAAY,KAAON,EACnB,MAAMU,EAAW,MAAMN,EAAM,IAAI,IAAK,CAAE,OAAQE,CAAW,CAAE,EACvD,CAAE,KAAAK,CAAI,EAAKD,EAAS,KAE1B,GAAIC,EAAK,SAAW,EAChB,OAAAC,EAAS,MAAM,CACX,MAAO,QACP,SAAU,YACV,QAAS,0EACzB,CAAa,EACM,QAAQ,IAAIF,EAAS,IAAI,EAGpC,IAAIG,EAAeF,EAAK,OACpB,CAACG,EAAMC,IACHD,EACA;AAAA,wDACwCC,EAAM;AAAA,sEACQA,EAAM,uBAAuBA,EAAM,sBAAsBA,EAAM;AAAA;AAAA;AAAA,2DAG1EA,EAAM;AAAA,2DACNA,EAAM;AAAA,8DACHA,EAAM;AAAA,+DACLA,EAAM;AAAA;AAAA,uBAGzD,EAAE,EACNrB,EAAY,mBAAmB,YAAamB,CAAY,EACxDX,EAAQ,QAAO,EACfc,IACIhB,GAAQC,EACRW,EAAS,KAAK,CACV,SAAU,YACV,QAAS,8CACzB,CAAa,EAGDK,GAEP,OAAQC,EAAP,CACE,QAAQ,MAAMA,CAAK,CACtB,CACL,CACApB,EAAe,iBAAiB,QAAS,SAAY,CACjDW,IACAD,IACAR,GAAQ,EACRM,EAAY,KAAON,EACnB,GAAI,CACA,MAAMO,EAAW,CACpB,OAAQW,EAAP,CACE,QAAQ,IAAIA,CAAK,CACpB,CAGD,MAAMC,EAFU,SAAS,cAAc,eAAe,EAC3B,wBACK,OAChC,OAAO,SAAS,CACZ,IAAKA,EAAa,EAClB,SAAU,QAClB,CAAK,CACL,CAAC,EAEDvB,EAAW,iBAAiB,SAAWwB,GAAU,CAK7C,GAJAA,EAAM,eAAc,EACpBpB,EAAO,EACPqB,IACAZ,IACId,EAAY,MAAM,KAAI,EAAG,SAAW,EAAG,CACvCiB,EAAS,MAAM,CACX,MAAO,QACP,SAAU,YACV,QAAS,+BACrB,CAAU,EACF,MACH,CACDJ,IACAF,EAAY,EAAIX,EAAY,MAC5BY,IACAZ,EAAY,MAAQ,EACxB,CAAC,EAED,SAAS0B,GAAc,CACnB3B,EAAY,gBAAe,CAC/B,CAEA,SAASsB,GAAoB,CACzBnB,EAAe,MAAM,WAAa,QACtC,CAEA,SAASW,GAAoB,CACzBX,EAAe,MAAM,WAAa,SACtC,CAEA,SAASoB,GAAiB,CACtBnB,EAAe,MAAM,WAAa,SACtC,CAEA,SAASW,GAAiB,CACtBX,EAAe,MAAM,WAAa,QACtC"}